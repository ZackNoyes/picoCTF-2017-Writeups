# Biscuit - 75 Points

Your friend has a personal website. Fortunately for you, he is a bit of a noob when it comes to hosting a website. Can you find out what he is hiding? [Website](http://shell2017.picoctf.com:19997/).

**Hint:** Viewing the source of the website is usually a good start.

## Writeup

As the hint suggests, the first thing you should do is head on over to the website and view its source. Right at the top is a very convenient comment:
```HTML
<!-- Storing stuff in the same directory as your web server doesn't seem like a good idea -->
<!-- Thankfully, we use a hidden one that is super PRIVATE, to protect our cookies.sqlite file -->
```

Scrolling a little further through the source code reveals that an image is loaded from the `/private` directory. Luckily, this directory is in fact not private but public and we can easily navigate to `http://shell2017.picoctf.com:19997/private/cookies.sqlite` to download the cookies.sqlite file. I used [http://inloop.github.io/sqlite-viewer/](http://inloop.github.io/sqlite-viewer/) to view the contents of this file (an sqlite database), which contains a single entry. This entry has a `name` of "ID" and a `value` of "F3MAqpWxIvESiUNLHsflVd", presumably the name and value of a cookie. Back on the provided website, I opened chrome's developer console and used a function I copied from w3schools to set a cookie with the recovered name and value. Refreshing the page resulted in the flag being displayed.

```JavaScript
function setCookie(cname, cvalue, cdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
    var expires = "expires="+d.toUTCString();
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}
```

## Helpful Resources

[http://inloop.github.io/sqlite-viewer/](http://inloop.github.io/sqlite-viewer/) 

[https://www.w3schools.com/js/js_cookies.asp](https://www.w3schools.com/js/js_cookies.asp)