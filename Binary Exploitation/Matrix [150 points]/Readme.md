# Enter the Matrix - 150 Points
The Matrix awaits you,. Take the [red pill](https://webshell2017.picoctf.com/static/6a932ca4e0c8977d96dc08b759a6a1aa/matrix) and begin your journey. [Source](https://webshell2017.picoctf.com/static/6a932ca4e0c8977d96dc08b759a6a1aa/matrix.c). Jack in at shell2017.picoctf.com:52501.

## Write-Up
This C program had a simple bug regarding the indexing of the matrix:
```c
INFO("Matrix[%d][%d] = %.9g", r, c, m->data[r * m->nrows + c]); //should be m->data[r * m->ncols + c]!
```
Instead of multiplying the row index by number of columns and adding column index, it multiplied with the number of rows. This faulty indexing allowed us to read/write beyond the memory segments of the matrix. With some experimentation, I used the following format to read and write memory (this one didn't require a script):
```
create 128 16
create 1 1
set 0 16 4 [ADDRESS] #convert address desired into
get 1 0 0 #this dereferences address above
set 1 0 0 [VALUE] #this sets the value of the address above
```
I replaced `[ADDRESS]` and `[VALUE]` with the values I wanted to use to read/write from memory. One hitch along the way involved trying to get a convert a float into hex number, and vice-versa. In the end, I just overrided the `GOT` table for `sscanf` with `system`, allowing me to execute any command by directly typing into the command shell.

## Helpful Resources
[https://www.h-schmidt.net/FloatConverter/IEEE754.html](https://www.h-schmidt.net/FloatConverter/IEEE754.html)